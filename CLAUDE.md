# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This repository contains a backup and restoration project for "Biblioteca Archimedica", a virtual library from Second Life that hosted book presentations and literary events from 2006-2008. The project aggregates content from multiple sources to preserve historical content.

## Repository Structure

### Content Sources (3 parallel data sources)

1. **`oldwp/`** - Static HTML extraction from WordPress site
   - Organized by year (2006/, 2007/, 2008/)
   - Contains the original WordPress theme and structure
   - Main entry: `oldwp/index.html`

2. **`waybiblio/`** - Wayback Machine scraped content (structured data)
   - `articles/` - Individual JSON files per article (10 articles)
   - `images/` - Downloaded images from archived pages
   - `summary.json` - Complete structured dataset
   - `summary.md` - Human-readable summary
   - Generated by the wayback-scraper tool

3. **`bibliotecaarchimedica.wordpress.2016-03-26.xml`** - WordPress export XML
   - Complete WordPress backup from 2016
   - Contains posts, pages, comments, categories

### Active Site

- **`index.html`** - Current landing page (simple background image with logo)
- Links to `/old` for archived content
- Hosted via GitHub Pages (see `CNAME` file)

### New Modern Site

**`newsite/`** - Modern glassmorphism redesign (2025)
- **Design**: Glassmorphism UI with pink/purple theme inspired by original Second Life library
- **Technology**: Static HTML + Tailwind CSS + Vanilla JavaScript
- **Content**: All 29 articles from WordPress XML export (2006-2008)
- **Encoding**: Full UTF-8 support with proper Italian character handling

Structure:
```
newsite/
├── index.html                    # Homepage with article listing
├── wordpress_posts.json          # Clean UTF-8 article data
├── css/style.css                 # Glassmorphism styles
├── js/main.js                    # Dynamic article loading
├── images/                       # Logo and background
│   ├── logo-biblioteca-archimedica.png
│   └── biblioteca-archimedica.jpg
└── articles/                     # 29 individual article pages
    ├── economia-canaglia.html
    ├── compleanno-archimedico.html
    └── ...
```

To preview locally:
```bash
cd newsite
python3 -m http.server 8000
# Open http://localhost:8000
```

### Content Generation Tools & Scripts

**Site Generation (for newsite/)**

- **`parse_wordpress_xml.py`** - Parse WordPress XML export to clean JSON
  - Extracts all published posts from XML export
  - Applies UTF-8 encoding fixes via `fix_encoding.py`
  - Generates `wordpress_posts.json` with 29 articles
  - Usage: `python3 parse_wordpress_xml.py`

- **`fix_encoding.py`** - UTF-8 encoding correction utility
  - Fixes mojibake (double-encoded UTF-8)
  - Converts Italian characters: è, à, ù, ò, ì, più, perché, etc.
  - Handles smart quotes and apostrophes
  - Can be imported and used in other scripts

- **`generate_article_pages.py`** - Generate individual HTML pages
  - Creates one HTML file per article in `newsite/articles/`
  - Uses glassmorphism template
  - Reads from `wordpress_posts.json`
  - Usage: `python3 generate_article_pages.py`

**To regenerate the entire newsite:**
```bash
# 1. Parse WordPress XML and fix encoding
python3 parse_wordpress_xml.py

# 2. Copy JSON to newsite
cp wordpress_posts.json newsite/

# 3. Generate all article HTML pages
python3 generate_article_pages.py
```

**Content Scraping**

- **`wayback-scraper/`** - Python-based Wayback Machine scraper
  - `wayback_scraper.py` - Main scraper class for archived sites
  - `rss_scraper.py` - RSS feed scraper
  - `README.md` - Complete usage documentation
  - Configurable for any Wayback Machine URL
  - Outputs structured JSON + Markdown summaries

**Legacy Tools**

- **`feed/`** - RSS/Atom feed generation tools
  - `pyatom/` - Python atom feed library
  - `feedcreator/` - Feed creation utilities

- **`app/`** - Legacy ebook catalog application
  - PHP-based ebook library system
  - Uses eBookLib framework (v0.7)
  - `catalog.php` - Main catalog interface

### Static Assets

- `shelf.json` - Book catalog metadata (Baker framework format)
- `ebook/`, `hpub/` - Digital book content directories
- Images: `biblioteca-archimedica.jpg`, `logo-biblioteca-archimedica.png`

## Working with the Wayback Scraper

### Running the scraper

```bash
cd wayback-scraper
pip3 install -r requirements.txt
python3 wayback_scraper.py
```

### Customizing for different archives

Edit the `main()` function in `wayback_scraper.py` to change:
- Target URL
- Output directory
- Max pages limit

### Output structure

The scraper creates:
- Individual JSON files per article
- Downloaded images with original filenames
- Consolidated summary files (JSON + Markdown)
- Metadata includes: title, date, author, content, images, URLs

## Content Migration Strategy

The repository preserves multiple versions of historical content and creates a modern presentation:

**Historical Archives (Read-Only)**
1. **Original HTML** (`oldwp/`) - Preserves visual presentation from 2016
   - 10 articles in RSS feed
   - Original WordPress theme and styling
2. **Wayback Machine scrape** (`waybiblio/`) - Structured data from archive.org
   - 10 articles with images
   - JSON format for programmatic access
3. **WordPress XML** (`bibliotecaarchimedica.wordpress.2016-03-26.xml`) - Complete backup
   - 29 published posts (most complete)
   - All metadata, comments, categories

**Modern Site (Generated)**
4. **New Site** (`newsite/`) - Modern glassmorphism redesign
   - Generated from WordPress XML (most complete source)
   - All 29 articles with proper UTF-8 encoding
   - Modern responsive design
   - Can be regenerated anytime from XML source

When working with content:
- **For most complete content**: Use WordPress XML → `wordpress_posts.json` → `newsite/`
- **For archival reference**: Check `oldwp/` or `waybiblio/`
- **To rebuild site**: Run the three Python scripts in sequence

## Key Historical Context

Biblioteca Archimedica was a Second Life virtual library (2007-2008) that:
- Hosted book presentations and author events
- Organized literary contests (e.g., "La scoperta del Metaverso")
- Covered topics: economics, education, religion, virtual worlds
- First anniversary: April 12, 2008

Main curator: archimedix (Archimedix Bulan in Second Life)

## Development Notes

**Old Site**
- Original `index.html` is static HTML hosted on GitHub Pages
- No build process required for main site
- Images are stored locally (not in CDN)

**New Site (`newsite/`)**
- Static HTML + Tailwind CSS (via CDN)
- No build process required
- All content generated from Python scripts
- Fully self-contained (can be deployed anywhere)
- Responsive design (mobile, tablet, desktop)

**Requirements**
- Python 3 required for:
  - Parsing WordPress XML
  - Fixing UTF-8 encoding
  - Generating HTML pages
  - Running local preview server
- PHP required for legacy `app/` catalog system (not actively used)

**Design System (newsite)**
- Colors: `#e91e63` (pink), `#9c27b0` (purple), `#673ab7` (deep purple)
- Glassmorphism effects: backdrop blur, transparency, colored shadows
- Typography: System sans-serif fonts
- Layout: CSS Grid + Flexbox with Tailwind utilities
